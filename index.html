<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Money Tracker</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f9;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .container {
      width: 400px;
      background: #90caf9;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 2px 2px 12px rgba(0,0,0,0.2);
      max-height: 90vh;
      overflow-y: auto;
    }
    h1, h2, h3 {
      text-align: center;
    }
    .form {
      display: flex;
      flex-direction: column;
      margin-bottom: 20px;
    }
    .form input, .form button {
      margin: 5px 0;
      padding: 10px;
      font-size: 16px;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      padding: 10px;
      margin: 5px 0;
      background: #f1f1f1;
      border-left: 5px solid;
    }
    li.income {
      border-color: green;
    }
    li.expense {
      border-color: red;
    }
    .form select {
      margin: 5px 0;
      padding: 10px;
      font-size: 16px;
    }
    #clear-btn , #toggleChartBtn, #pdf-btn {
      display: block; 
      margin: 20px auto;    
      padding: 10px 20px;
      background-color: #ff4d4d;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s ease;
    }
    #clear-btn:hover, #toggleChartBtn:hover, #pdf-btn:hover {
      background-color: #e60000;
      transform: scale(1.05);
    }
    #clear-btn:active, #toggleChartBtn:active, #pdf-btnz:active  {
      background-color: #cc0000;
      transform: scale(0.95);
    }
    .category {
      font-size: 0.85em;
      font-style: italic;
      color: #666;
    }
    .edit-btn, .delete-btn {
      margin-left: 10px;
      border: none;
      padding: 5px 8px;
      cursor: pointer;
      border-radius: 4px;
      font-size: 14px;
    }
    .edit-btn {
      background: rgb(41, 193, 41);
    }
    .delete-btn {
      background: red;
      color: white;
    }
    .transaction-main {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .transaction-actions {
      display: flex;
      gap: 8px; 
    }
    .date {
      font-size: 12px;
      color: #555;
      margin-top: 4px;   
      margin-left: 2px;  
    }
    #chartContainer {
      display: none;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Money Tracker</h1>
    <h2 id="balance">Current Balance: $0</h2>
    <h3 id="income">Total Income: $0</h3>
    <h3 id="expense">Total Expense: $0</h3>
    <div class="form">
      <input type="text" id="desc" placeholder="Enter description">
      <label for="category">Category:</label>
      <select id="category">
        <option value="Food">Food</option>
        <option value="Travel">Travel</option>
        <option value="Shopping">Shopping</option>
        <option value="Bills">Bills</option>
        <option value="Salary">Salary</option>
        <option value="Other">Other</option>
      </select>
      <select id="type">
        <option value="income">Income</option>
        <option value="expense">Expense</option>
      </select>
      <input type="number" id="amount" placeholder="Enter amount">
      <button onclick="addTransaction()">Add</button>
    </div>
    <h3>Transaction History</h3>
    <ul id="transactions"></ul>
    <button id="clear-btn" onclick="clearTransactions()">Clear All Transactions</button> 
    <button id="pdf-btn" onclick="exportToPDF()">Export to PDF</button>
    <button id="toggleChartBtn">Show Income vs Expense Chart</button>
    <div id="chartContainer">
      <canvas id="incomeExpenseChart"></canvas>
    </div>
    </div>
  </div>
  <script>
  let balance = 0;
  let transactions = [];
  let editIndex = null; 
  let chartInstance = null;
  function addTransaction() {
    const desc = document.getElementById("desc").value;
    const type = document.getElementById("type").value;
    const amount = Number(document.getElementById("amount").value);
    const category = document.getElementById("category").value;
    if (desc === "" || amount <= 0) {
      alert("Please enter valid data!");
      return;
    }
    const finalAmount = type === "income" ? amount : -amount;
    if (editIndex !== null) {
      const old = transactions[editIndex];
      balance -= old.amount; 
      transactions[editIndex] = { desc, amount: finalAmount, category, date: old.date };
      balance += finalAmount;
      editIndex = null; 
    } else {
      const transaction = { desc, amount: finalAmount, category, date: new Date().toLocaleString() };
      transactions.push(transaction);
      balance += finalAmount;
    }
    updateUI();
    document.getElementById("desc").value = "";
    document.getElementById("amount").value = "";
    document.getElementById("category").value = "Other";
  }
  function updateUI() {
    document.getElementById("balance").innerText = `Balance: $${balance}`;
    let income = transactions
      .filter(t => t.amount > 0)
      .reduce((acc, t) => acc + t.amount, 0);
    let expense = transactions
      .filter(t => t.amount < 0)
      .reduce((acc, t) => acc + Math.abs(t.amount), 0);
    document.getElementById("income").innerText = `Total Income: $${income}`;
    document.getElementById("expense").innerText = `Total Expense: $${expense}`;
    const list = document.getElementById("transactions");
    list.innerHTML = "";
    transactions.forEach((t, index) => {
      const li = document.createElement("li");
      li.innerHTML = `
        <div class="transaction-main">
          <span>${t.desc} (${t.category}): $${t.amount}</span>
          <div class="transaction-actions">
            <button class="edit-btn" onclick="editTransaction(${index})">Edit</button>
            <button class="delete-btn" onclick="deleteTransaction(${index})">Delete</button>
          </div>
        </div>
        <div class="date">${t.date}</div>
      `;
      li.classList.add(t.amount > 0 ? "income" : "expense");
      list.appendChild(li);
    });
    if (document.getElementById("chartContainer").style.display === "block") {
      renderChart(); 
    }
  }
  function editTransaction(index) {
    const t = transactions[index];
    document.getElementById("desc").value = t.desc;
    document.getElementById("amount").value = Math.abs(t.amount);
    document.getElementById("category").value = t.category;
    document.getElementById("type").value = t.amount > 0 ? "income" : "expense";
    editIndex = index; 
  }
  function deleteTransaction(index) {
    balance -= transactions[index].amount; 
    transactions.splice(index, 1);
    updateUI();
  }
  function clearTransactions() {
    if (confirm("Are you sure you want to delete all transactions?")) {
      transactions = [];
      balance = 0;
      updateUI();
    }
  }
  document.getElementById("toggleChartBtn").addEventListener("click", () => {
    const chartContainer = document.getElementById("chartContainer");
    if (chartContainer.style.display === "none") {
      chartContainer.style.display = "block";
      document.getElementById("toggleChartBtn").textContent = "Hide Income vs Expense Chart";
      renderChart();
    } else {
      chartContainer.style.display = "none";
      document.getElementById("toggleChartBtn").textContent = "Show Income vs Expense Chart";
    }
  });
  function renderChart() {
    const ctx = document.getElementById("incomeExpenseChart").getContext("2d");
    let income = 0, expense = 0;
    transactions.forEach(t => {
      if (t.amount > 0) income += t.amount;
      else expense += Math.abs(t.amount);
    });
    if (chartInstance) {
      chartInstance.destroy();
    }
    chartInstance = new Chart(ctx, {
      type: "bar",
      data: {
        labels: ["Income", "Expense"],
        datasets: [{
          label: "Amount",
          data: [income, expense],
          backgroundColor: ["#4caf50", "#f44336"]
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: false },
          title: { display: true, text: "Income vs Expense" }
        }
      }
    });
  }
  async function exportToPDF() {
    if (transactions.length === 0) {
        alert("No transactions to export!");
        return;
    }
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    doc.setFontSize(18);
    doc.text("Transaction Report", doc.internal.pageSize.getWidth() / 2, 20, { align: "center" });
    let income = transactions.filter(t => t.amount > 0).reduce((a, b) => a + b.amount, 0);
    let expense = transactions.filter(t => t.amount < 0).reduce((a, b) => a + Math.abs(b.amount), 0);
    doc.setFontSize(12);
    doc.text(`Balance: $${balance}`, 14, 25);
    doc.text(`Total Income: $${income}`, 14, 32);
    doc.text(`Total Expense: $${expense}`, 14, 39);
    const tableColumn = ["Date & Time", "Description", "Category", "Type", "Amount"];
    const tableRows = [];
    transactions.forEach(t => {
        const row = [
            t.date,
            t.desc,
            t.category,
            t.amount > 0 ? "Income" : "Expense",
            "$" + Math.abs(t.amount)
        ];
        tableRows.push(row);
    });
    doc.autoTable({
        head: [tableColumn],
        body: tableRows,
        startY: 50,
        theme: "grid",
        headStyles: { fillColor: [41, 128, 185] }, 
        styles: { fontSize: 10, cellPadding: 3 }
    });
    doc.save("transactions.pdf");
}
</script>
</body>
</html>
